<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Admin Pro v8 - Expert Edition</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div id="toastContainer" class="toast-container"></div>

    <div id="loginScreen" class="modal-overlay" style="display:flex; background:var(--bg-gradient);">
        <div class="glass-panel" style="padding:50px; text-align:center; width:400px;">
            <h1 class="brand">üöÄ Sales Admin <span>Pro</span></h1>
            <p style="color:var(--text-sub); margin-bottom:30px;">Premium Expert Dashboard</p>

            <div
                style="display:flex; background:rgba(0,0,0,0.05); padding:5px; border-radius:12px; margin-bottom:25px;">
                <button class="nav-item active" style="flex:1; justify-content:center; margin:0;"
                    onclick="app.setLoginMode('ADMIN')">Admin</button>
                <button class="nav-item" style="flex:1; justify-content:center; margin:0;"
                    onclick="app.setLoginMode('BRANCH')">Branch</button>
                <button class="nav-item" style="flex:1; justify-content:center; margin:0;"
                    onclick="app.setLoginMode('STAFF')">Staff</button>
            </div>

            <div id="loginForms">
                <div id="formAdmin">
                    <input type="text" id="adminId" placeholder="ID: admin" class="btn-outline"
                        style="width:100%; margin-bottom:10px; text-align:left;">
                    <input type="password" id="adminPw" placeholder="PW: 1234" class="btn-outline"
                        style="width:100%; margin-bottom:20px; text-align:left;">
                </div>
                <div id="formBranch" style="display:none;">
                    <select id="loginBranchSelect" class="btn-outline" style="width:100%; margin-bottom:10px;">
                        <option>Select Branch</option>
                    </select>
                    <input type="password" id="branchPw" placeholder="PW: 1234" class="btn-outline"
                        style="width:100%; margin-bottom:20px; text-align:left;">
                </div>
                <div id="formStaff" style="display:none;">
                    <select id="loginStaffBranch" class="btn-outline" style="width:100%; margin-bottom:10px;">
                        <option>Select Branch</option>
                    </select>
                    <input type="text" id="loginStaffName" placeholder="Name" class="btn-outline"
                        style="width:100%; margin-bottom:10px; text-align:left;">
                    <input type="password" id="staffPw" placeholder="Phone 1234" class="btn-outline"
                        style="width:100%; margin-bottom:20px; text-align:left;">
                </div>
                <button onclick="app.login()" class="btn-gradient" style="width:100%;">Sign In</button>
            </div>
        </div>
    </div>

    <div class="app-container" style="display:none;">
        <nav class="sidebar glass-panel">
            <div class="brand">üöÄ Sales <span>Admin</span></div>

            <div style="display:flex; flex-direction:column; gap:5px; width:100%;">
                <div class="nav-item active" onclick="app.showTab('dashboard')"><span>üìä</span> <span>Dashboard</span>
                </div>
                <div class="nav-item" onclick="app.showTab('list')"><span>üìù</span> <span>Performance</span></div>
                <div class="nav-item" onclick="app.toggleTop10()"><span>üèÜ</span> <span>Top 10 Experts</span></div>
                <div class="nav-item admin-only" onclick="app.showTab('settings')"><span>‚öôÔ∏è</span> <span>Settings</span>
                </div>
            </div>

            <div style="margin-top:auto; border-top:1px solid rgba(0,0,0,0.1); padding-top:20px;">
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                    <div
                        style="width:36px; height:36px; background:var(--primary); border-radius:50%; color:white; display:flex; align-items:center; justify-content:center; font-weight:bold;">
                        U</div>
                    <div style="flex:1;">
                        <div id="uName" style="font-weight:700; font-size:13px;">User</div>
                        <div id="uRole" style="font-size:11px; color:var(--text-sub);">Role</div>
                    </div>
                </div>
                <button onclick="app.logout()" class="btn-outline" style="width:100%; text-align:center;">Sign
                    Out</button>
            </div>
        </nav>

        <main class="content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="page">
                <header style="margin-bottom:30px;">
                    <h2 style="font-size:24px; font-weight:800; margin:0;">Analytics Dashboard</h2>
                    <p style="color:var(--text-sub);">Real-time performance overview</p>
                </header>

                <div class="dashboard-grid">
                    <!-- Key Metrics Cards -->
                    <div class="stat-card glass-panel blue-card">
                        <h3>New Sales</h3>
                        <div class="value" id="dNew">0</div>
                        <div class="trend"><span>üéØ</span> <span id="tNew">Target: 0</span></div>
                        <div class="icon">üíº</div>
                    </div>
                    <div class="stat-card glass-panel green-card">
                        <h3>New Subscriptions</h3>
                        <div class="value" id="dSub">0</div>
                        <div class="trend"><span>üìà</span> Growing</div>
                        <div class="icon">üìù</div>
                    </div>
                    <div class="stat-card glass-panel orange-card">
                        <h3>Suspensions</h3>
                        <div class="value" id="dSus">0</div>
                        <div class="trend"><span>‚ö†Ô∏è</span> Action Required</div>
                        <div class="icon">‚õî</div>
                    </div>
                    <div class="stat-card glass-panel red-card">
                        <h3>Cancellations</h3>
                        <div class="value" id="dCan">0</div>
                        <div class="trend"><span>üìâ</span> <span id="tCan">Limit: 0</span></div>
                        <div class="icon">üö®</div>
                    </div>

                    <!-- 5 Advanced Charts -->
                    <!-- 1. Trend Analysis (Line) -->
                    <div class="chart-card full glass-panel">
                        <div class="chart-header">
                            <h3>üìà Monthly Performance Trend</h3>
                        </div>
                        <div class="chart-wrapper"><canvas id="chartTrend"></canvas></div>
                    </div>

                    <!-- 2. Branch Performance (Bar) -->
                    <div class="chart-card glass-panel">
                        <div class="chart-header">
                            <h3>üè¢ Branch Performance (New)</h3>
                        </div>
                        <div class="chart-wrapper"><canvas id="chartBranch"></canvas></div>
                    </div>

                    <!-- 3. Composition (Doughnut) -->
                    <div class="chart-card glass-panel">
                        <div class="chart-header">
                            <h3>ü•ß Sales Share by Branch</h3>
                        </div>
                        <div class="chart-wrapper" style="padding:20px;"><canvas id="chartShare"></canvas></div>
                    </div>

                    <!-- 4. Top 10 Ranking (Horizontal Bar) -->
                    <div class="chart-card glass-panel" style="grid-column: span 8;">
                        <div class="chart-header">
                            <h3>üèÜ Top Performer Ranking (Incentive)</h3>
                        </div>
                        <div class="chart-wrapper"><canvas id="chartRank"></canvas></div>
                    </div>

                    <!-- 5. Efficiency Radar -->
                    <div class="chart-card glass-panel" style="grid-column: span 4;">
                        <div class="chart-header">
                            <h3>‚ö° Metric Balance</h3>
                        </div>
                        <div class="chart-wrapper"><canvas id="chartRadar"></canvas></div>
                    </div>

                </div>
            </section>

            <!-- List Section -->
            <section id="list" class="page" style="display:none;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h2>Performance Records</h2>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="searchInput" placeholder="Search..." class="btn-outline"
                            onkeyup="app.filterList()">
                        <select id="filterBranch" class="btn-outline" onchange="app.filterList()">
                            <option value="ALL">All Branches</option>
                        </select>
                        <button onclick="app.downloadCSV()" class="btn-gradient">Export CSV</button>
                    </div>
                </div>
                <div class="glass-panel table-container">
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th onclick="app.sort('branch')">Branch</th>
                                <th onclick="app.sort('manager')">Manager</th>
                                <th onclick="app.sort('nc')">New</th>
                                <th>Sub</th>
                                <th>Cancel</th>
                                <th>Suspend</th>
                                <th>Retention</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="listBody"></tbody>
                    </table>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="page" style="display:none;">
                <h2>Settings</h2>
                <div class="glass-panel" style="padding:30px; margin-top:20px;">
                    <h3>Data Management</h3>
                    <div style="display:flex; gap:10px; margin-top:20px;">
                        <button onclick="app.initData()" class="btn-gradient">Reset Data (Random)</button>
                        <button onclick="app.backupData()" class="btn-outline">Backup JSON</button>
                        <input type="number" id="inpFee" placeholder="Unit Fee" class="btn-outline" value="30">
                        <button onclick="app.updateFee()" class="btn-gradient">Update Fee</button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Top 10 Sidebar Overlay -->
        <div id="top10Panel" class="glass-panel"
            style="position:fixed; right:-400px; top:20px; bottom:20px; width:350px; z-index:3000; transition:0.3s; display:flex; flex-direction:column;">
            <div class="ranking-header">
                <h3>üèÜ Hall of Fame</h3>
                <button onclick="app.toggleTop10()" class="btn-outline" style="border:none;">‚úï</button>
            </div>
            <div id="top10List" class="ranking-list"></div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="inputModal" class="modal-overlay">
        <div class="modal-content glass-panel">
            <div style="padding:20px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                <h3 style="margin:0;">Update Metrics</h3>
                <button onclick="app.closeModal()"
                    style="border:none; bg:transparent; cursor:pointer; font-size:20px;">‚úï</button>
            </div>
            <div style="padding:24px; display:grid; grid-template-columns:1fr 1fr; gap:16px;">
                <input type="hidden" id="editId">
                <div><label>New Sales</label><input type="number" id="inpNew" class="btn-outline" style="width:100%">
                </div>
                <div><label>Subscription</label><input type="number" id="inpSub" class="btn-outline" style="width:100%">
                </div>
                <div><label>Cancellation</label><input type="number" id="inpCancel" class="btn-outline"
                        style="width:100%"></div>
                <div><label>Suspension</label><input type="number" id="inpSuspend" class="btn-outline"
                        style="width:100%"></div>
                <div><label>Retention</label><input type="number" id="inpRetention" class="btn-outline"
                        style="width:100%"></div>
                <div><label>Note</label><input type="text" id="inpNote" class="btn-outline" style="width:100%"></div>
            </div>
            <div style="padding:20px; background:rgba(0,0,0,0.02); text-align:right;">
                <button onclick="app.saveModalData()" class="btn-gradient">Save Changes</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>